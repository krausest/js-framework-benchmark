(function(n){var t=n.document,d=n.setInterval,st=n.setTimeout,g=n.clearInterval,ht=n.clearTimeout,r=t.createElement("template"),c={},l={"class":{n:"class",u:!0},style:{n:"style",u:!0},id:{n:"id",u:!0}},o=null,v="hashes",e=null,y=null,w=null,u=null,f="",p=null,nt=function(r){(function(){var n=Array.prototype,t,r;n.remove=function(n){var t=this.indexOf(n);t!==-1&&this.splice(t,1)};n.removeAll=function(){this.splice(0,this.length)};t=function(t,r){var u,f,e,o,s,h,c,l,a,v,y;t.tracking||(t.tracking=[]);u=this;f=t.tracking;u.changed=!0;e=function(n,i,r,u){var e,o;for(t.suppress=!0,e=0;e<f.length;e++)r.apply(this,[f[e],u]),f[e].changed=!0;return o=n.apply(t,i),t.suppress=!1,o};f.length===0&&(o=function(n,t){for(var i=0;i<t.length;i++)n.i.push(-1)},t.push=function(){return e(n.push,arguments,o,arguments)},s=function(n){var t=n.i.pop();t>=0&&n.d.push(t)},t.pop=function(){return e(n.pop,arguments,s)},h=function(n){var t=n.i.shift();t>=0&&n.d.push(t)},t.shift=function(){return e(n.shift,arguments,h)},c=function(n,t){for(var i=0;i<t.length;i++)n.i.unshift(-1)},t.unshift=function(){return e(n.unshift,arguments,c,arguments)},l=function(t,i){var u=t.i.slice(0),r;for(n.copyWithin.apply(t.i,i),r=0;r<u.length;r++)t.i.indexOf(u[r])===-1&&u[r]>=0&&t.d.push(u[r])},t.copyWithin=function(){return e(n.copyWithin,arguments,l,arguments)},a=function(t){n.reverse.apply(t.i)},t.reverse=function(){return e(n.reverse,arguments,a)},v=function(t,i){for(var u=n.splice.apply(t.i,i),r=0;r<u.length;r++)u[r]>=0&&t.d.push(u[r])},t.splice=function(){var t=n.slice.apply(arguments,[0]);for(i=2;i<t.length;i++)t[i]=-1;return e(n.splice,arguments,v,t)},y=function(n,t){for(var r=[],i=0;i<t.length;i++)r.push(n.i[t[i].i]);n.i=r},t.sort=function(){var r=[],e=null,i=0,u=arguments,o;for(t.suppress=!0,i=0;i<t.length;i++)r.push({i:i,v:u.length>0||t[i]===undefined||typeof t[i]=="string"?t[i]:t[i].toString()});for(e=u.length>0?function(n,t){return u[0](n.v,t.v)}:function(n,t){return n.v===t.v?0:n.v===undefined?1:t.v===undefined?-1:n.v<t.v?-1:n.v>t.v?1:0},n.sort.apply(r,[e]),i=0;i<f.length;i++)y(f[i],r),f[i].changed=!0;for(o=t.slice(0),i=0;i<r.length;i++)t[i]=o[r[i].i];return t.suppress=!1,t},t.markChange=function(n,i){var u,r,e;if(!t.suppress)for(u=0;u<f.length;u++)r=f[u],r.v||r.eval(),e=r.v.indexOf(i),e===-1&&e--,r.d.push(r.i[n]),r.i[n]=e,r.changed=!0});f.push(u);u.eval=function(){u.v=r()};u.cancel=function(){f.remove(u);f.length===0&&(delete t.push,delete t.pop,delete t.shift,delete t.unshift,delete t.copyWithin,delete t.reverse,delete t.splice,delete t.sort,delete t.markChange)};u.changes=function(){var n=0,i=0,r;if(u.i&&!t.isBindable)for(u.v||u.eval(),n=0;n<u.i.length;n++)i=u.i[n],i>=0&&t[n]!==u.v[i]&&t.markChange(n,t[n]);if(u.changed){if(u.d)for(u.d.sortNumeric(),n=0;n<u.d.length;n++)(u.d[n]===u.d[n+1]||u.i.indexOf(u.d[n])!==-1)&&(u.d.splice(n,1),n--);for(r={indexes:u.i,deleted:u.d},u.i=[],u.d=[],u.v=null,n=0;n<t.length;n++)u.i.push(n);return u.changed=!1,r}};u.changes()};n.track=function(n){return new t(this,n)};r=function(n,t){return n>t?1:t>n?-1:0};n.sortNumeric=function(){this.sort(r)}})(),function(){var t;if(n.BindingArray=function(){},t=function(i){return n.Proxy?new n.BindingArray(t,i):i},n.Proxy){var i=Object.getOwnPropertyDescriptor(n.BindingArray.prototype,"constructor"),r={set:function(n,t,i){return n.suppress||isNaN(t)||!n.markChange||n.markChange(parseInt(t),i),n[t]=i,!0},get:function(n,t){return t!=="isBindable"?n[t]:!0}},u={construct:function(n,i){return new Proxy(i.length===2&&i[0]===t?i[1]:[],r)}};i.value=new Proxy(n.BindingArray,u);n.BindingArray=i.value}else n.BindingArray=Array;n.BindingArray.createFrom=t}(),function(){var n=window,u=n.setTimeout,e=n.setInterval,f=n.XMLHttpRequest.prototype,o=f.send,i=n.HTMLElement.prototype,s=n.String.prototype;n.setTimeout=function(n,t,i){return u.apply(this,[i?n:function(){n();r()},t])};n.setInterval=function(n,t,i){return e.apply(this,[i?n:function(){n();r()},t])};n.defer=function(n){u.apply(this,[n,0])};n.parseBool=function(n){return typeof n=="string"?n.toLowerCase()==="true":!!n};f.send=function(){var t=this,i="addEventListener",u=t.onreadystatechange;return t.onreadystatechange=function(){var e=u?u.apply(t,arguments):null,f;return t.readyState===4&&(f=function(){t.updated||(n.defer(r),t.updated=!0)},t[i]("load",f),t[i]("error",f),t[i]("aborts",f)),e},o.apply(t,arguments)};i.empty=function(){while(this.firstChild)this.removeChild(this.firstChild)};i.insertAt=function(n,t){t===-1?this.appendChild(n):this.insertBefore(n,this.childNodes[t])};i.raiseEvent=function(n,i){var r=t.createEvent("CustomEvent");r.initCustomEvent(n,!0,!0,i);this.element.dispatchEvent(r)};i.getIndex=function(){return this.parentElement?[].slice.apply(this.parentElement.childNodes).indexOf(this):0};i.on=function(){return this.addEventListener.apply(this,arguments)};i.off=function(){return this.removeEventListener.apply(this,arguments)};s.toJsName=function(){for(var n=this.toLowerCase().split("-"),t=1;t<n.length;t++)n[t].length>0&&(n[t]=n[t].charAt(0).toUpperCase()+n[t].substring(1));return n.join("")};Comment.prototype.getIndex=i.getIndex}()},tt=function(n,t){var i=this,r;i.name=n;i.type=t;r=function(n,t){i.isSingleton=t;i.initialize=n};i.with=function(){return i.services=arguments,i};t===2&&(i.routes=[],i.at=function(){return i.routes=arguments,i},i.forRoutingErrors=function(){return i.isRoutingErrorView=!0,i});t===3&&(i.forExpressions=function(){return i.expressionsOnly=!0,i},i.toControlContent=function(){return i.controlsContent=!0,i});t===4?(i.asSingleton=function(n){r(n,!0)},i.asTransient=function(n){r(n,!1)}):i.as=function(n){r(n)}},it=function(n,t){var i=this;i.services=[];i.with=function(){return i.services=arguments,i};i.as=function(r){for(var f=[],u=0;u<i.services.length;u++)f.push(e.createService(i.services[u],t));resonate.expressions[n.charAt(0).toLowerCase()+n.substring(1)]=r.apply(this,f)}},rt=function(n){var t=this;t.name=n;t.forRoutes=function(){return t.routes=arguments,t};t.withModules=function(){t.modules=arguments}},ut=function(){var n=this;n.files=[];n.loaded={};n.locales={};n.forLocales=function(){n.locales.default=arguments[0];for(var t=0;t<arguments.length;t++)n.locales[arguments[t]]=!0;return n};n.withDefault=function(t){return n.default=t,n};n.from=function(t){return n.files.push(t.toLowerCase()),{and:n.from}};n.providedBy=function(t){n.provider=t}},ft=function(){var n=this,t=navigator,r="";n.subscribers=[];r=t.languages&&t.languages.length?t.languages[0]:t.userLanguage||t.language||t.browserLanguage||"en-gb";n.locale=r.toLowerCase();n.refresh=function(){for(i=0;i<n.subscribers.length;i++)n.subscribers[i](),resonate.refresh()};n.changeLocale=function(t){n.locale=t;for(var i=0,r=[],u=Object.keys(resonate.modules),i=0;i<u.length;i++)r.push(resonate.modules[u[i]].loadLocalization(t));Promise.all(r).then(n.refresh)};n.getLocale=function(){return n.locale}},a=function(t,i,f){var e=this,s,y;e.name=t;e.components={id:1};e.views={id:2};e.attributes={id:3};e.services={id:4};e.localization={};var h=[],a=function(n,t){var u=e[t],r=new tt(n,u.id,i);return r.module=e,n=n.toLowerCase(),u[n]=r,i[t][n]=r,r},p=function(n,t){var e,f,s;n.charAt(0)!=="/"&&(n="/"+n);var h=n.split("/"),r=i.routes,o=!1,u=null;for(e=1;e<h.length;e++)if(u=h[e],u.indexOf("{")===0){for(o=!1,f=0;f<r["!!"].length;f++)r["!!"][f].value===u&&(r=r["!!"][f].routes,o=!0);o||(s={routes:{"!!":[]},name:u.substring(1,u.indexOf("}"))},r["!!"].push(s),r=s.routes)}else u=u.toLowerCase(),r[u]||(r[u]={"!!":[]}),r=r[u];r["@@"]=t},v=function(n,t){var u=a(n,t),r=n.toLowerCase(),i=c[r];return i||(i={n:r},c[r]=i),i.x=u,u};e.parseNode=function(n,t){var i=null,r,s,u,v,y,f;switch(n.nodeType){case 1:if(r=0,s=n.localName.toLowerCase(),s==="stet")return{v:n.innerHTML};for(u=c[s],u||(u={n:s},c[s]=u),i={k:u,a:[],e:[],c:[]},r=0;r<n.attributes.length;r++){var h=n.attributes[r].localName.toLowerCase(),p=h.substring(0,2)==="on",o=l[h];o||(o={n:p?h.substring(2):h},l[h]=o);var w=n.attributes[r].nodeValue,b=expressions.isExpression(w),a={k:o,v:w,p:i},k=p&&b?i.e:i.a;o.x&&o.x.controlsContent?k.unshift(a):k.push(a);b&&t.push(a)}for(v=u.x&&u.x.type===1,y=!1,r=0;r<n.childNodes.length;r++)f=e.parseNode(n.childNodes[r],t),f&&(f.p=i,i.c.push(f),v&&(f.k||f.v&&f.v.trim()!=="")&&(y=!0));v&&!y&&(i.c=[]);break;case 3:i={v:n.nodeValue};expressions.isExpression(n.nodeValue)&&t.push(i)}return i};e.createComponent=function(n){return v(n,"components")};e.createView=function(n){return v(n,"views")};e.createAttribute=function(n){var r=a(n,"attributes"),i=n.toLowerCase(),t=l[i];return t||(t={n:i},l[i]=t),t.x=r,r};e.createService=function(n){return a(n,"services")};e.createExpression=function(n){return new it(n,e)};e.setLocalization=function(){var t=new ut(e);return h.push(t),f&&n.setTimeout(function(){e.loadLocalization(u.locale)},0),t};e.applyTemplates=function(n){var s,u,h,o,t,c;for(r.innerHTML=n,s=r.content?r.content.children:r.children,u=0;u<s.length;u++){var l=s[u].tagName.toLowerCase(),f=e.components[l],a=[];f||(f=e.views[l]);f&&(f.template=e.parseNode(s[u],a),f.expressions=a)}for(r.innerHTML="",h=Object.keys(e.views),o=0;o<h.length;o++)if(h[o]!=="id")for(t=i.views[h[o]],t.isRoutingErrorView&&(i.routes["@routing-error"]=t),c=0;c<t.routes.length;c++)p(t.routes[c],t)};s=function(n){for(var i=Object.keys(n),t=0;t<i.length;t++)e.localization[i[t]]=n[i[t]]};y=function(n,t){return new Promise(function(i){o.loadDirect(n).then(function(r){try{var u=JSON.parse(r);t.loaded[n]=u;s(u)}catch(f){}i()})})};e.loadLocalization=function(n){var v=[],f,t,r,c,i,o,l,a;for(e.localization={},f=0;f<h.length;f++)if(t=h[f],r=n,t.locales[r]||(r=t.locales.default),c=t.provider,c)i=c(r),i&&i.then&&typeof i.then=="function"?i.then(function(n){s(n);u.refresh()}):s(i);else for(o=0;o<t.files.length;o++)l=t.files[o].replace("{locale}",r),a=t.loaded[l],a?s(a):v.push(y(l,t));return Promise.all(v)}},et=function(i){var r=this,e="",h=["load","error","abort"];i.modules={};i.components={};i.views={};i.routes={"!!":[]};i.areas=[];i.attributes={};i.services={};i.modules.resonate=new a("Resonate",i,!0);p=new a;i.createBodyComponent=function(){return i.inModule("resonate").createComponent("@body")};i.setLocalization=function(){return i.modules.resonate.setLocalization()};i.createModule=function(n){n=n.toLowerCase();var t=new a(n,i,!0);return i.modules[n]=t,t};i.createArea=function(t){var r=new rt(t);return n.setTimeout(function(){i.areas.push(r)},0),r};i.inModule=function(n){var t=i.modules[n.toLowerCase()];if(!t)throw new Error("The module '"+n+"' was not found.");return t};var o=function(n){return new Promise(function(t){for(var i=new XMLHttpRequest,u=function(){t(i.responseText)},r=0;r<h.length;r++)i.addEventListener(h[r],u);i.open("GET",n);i.send()})},c=function(n,i){return new Promise(function(r){var u=t.createElement(n);u.addEventListener("load",r);u.addEventListener("error",r);n==="link"?(u.rel="stylesheet",u.type="text/css",u.href=i):u.src=i;t.head.appendChild(u)})},y=function(n,t){return new Promise(function(i){c("script",n).then(function(){t.loadLocalization(u.locale).then(i)})})},l=function(n){return new Promise(function(t){n=n.toLowerCase().trim();var u=e+"/"+n,r=[],f=new a(n,i);i.modules[n]=f;r.push(y(u+".min.js",f));r.push(c("link",u+".min.css"));r.push(o(u+".html",{}));Promise.all(r).then(function(n){f.applyTemplates(n[2]);t()})})},s=function(n,t,i){var r=t.attributes[n];return r?r.nodeValue.trim().toLowerCase():i};r.loadModules=function(n){for(var r=[],t=0;t<n.length;t++)i[n[t]]||r.push(l(n[t]));return Promise.all(r)};r.loadInitial=function(){var i,l,h,n,a,y,c,p;for(u=new ft(o),i=[],l=t.getElementsByTagName("script"),h=0;h<l.length;h++){if(n=l[h],a=n.attributes["resonate-modules"],a)for(y=a.nodeValue.split(","),c=0;c<y.length;c++)p=y[c].trim(),p&&i.push(p);e="/"+s("resonate-modules-path",n,e);v=s("resonate-routing",n,v);f=s("resonate-path",n,f)}return i.length===0&&(r.autoMode=!1),r.loadModules(i)};i.loadModule=l;r.autoMode=!0;r.loadDirect=o},ot=function(){for(var i=this,u=["true","false","null","undefined","new","event","typeof","Math","NaN","isFinite","isNaN","parseFloat","parseInt","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","window","console","JSON"],f=["=","!",">","<","&","|","?",":","(",")","[","]","{","}",",",";"," ","+","-","*","/","\\","%","^","'",'"',"."],e={},r={},t=0,s={"{":!0,"(":!0,"[":!0},h={"}":!0,")":!0,"]":!0},t=0;t<u.length;t++)e[u[t]]=!0;for(t=0;t<f.length;t++)r[f[t]]=!0;window.addEventListener("error",function(n){var t=n.error;t&&(t.message&&(t.message=t.message.replace("__scope.","").replace("__value","")),console.error(t));n.preventDefault();n.stopImmediatePropagation()});var c=function(n){var c="",o=0,i="",a=!1,v=!1,l=!1,y=0,u=n.e.trim(),t;for(u.charAt(0)==="{"&&(n.p["in-only"]=!0),t=0;t<=u.length;t++)if(i=u.charAt(t),l=r[i],v=!l&&t===u.length-1,l&&!a||v){if(s[i]&&y++,(y===0&&l&&i!=="."||t===u.length-1&&i===")")&&(n.p["in-only"]=!0),h[i]&&y--,o<t||v){var f=u.substring(o,v?t+1:t),p=e[f],w=f.charAt(0)==="@";if(y===0&&(p||w||!isNaN(f))&&(n.p["in-only"]=!0),w){if(c+="resonate.expressions."+f.substring(1),f==="@localize"){for(c+="(__scope, ";u.charAt(t)!=="("&&t<=u.length;)t++;t++;i=u.charAt(t);l=r[i]}}else c+=o!==0&&u.charAt(o-1)==="."||!isNaN(f)||p?f:"__scope."+f;o=t}(i==='"'||i==="'")&&(a=!0);l&&(c+=i,o++)}else a&&((i==='"'||i==="'")&&(t===0||u.charAt(t-1)!=="\\")&&(a=!1),o++,c+=i);return c},l=function(n){var t,r,u,i;if(n=n.trim(),n.charAt(0)==="["&&(t=n.indexOf("]"),t!==-1)){for(r={e:n.substring(t+1),p:{}},u=n.substring(1,t).toLowerCase().split(","),i=0;i<u.length;i++)r.p[u[i].trim()]=!0;return r}return{e:n,p:{}}},a=function(n){for(var u=[],f=0,e=0,r=0,o=0,t=0,i=0;;)if(t=n.indexOf("{",o),i=n.indexOf("}",o),t>i||t===-1?(f--,f===0&&(r<e&&u.push({v:n.substring(r,e)}),u.push(l(n.substring(e+1,i))),r=i+1),o=i+1):(f===0&&(e=t),o=t+1,f++),t===-1&&i===-1)break;return r<n.length&&u.push({v:n.substring(r)}),u},o=function(t,i){var u=t.p["no-errors"],r={},f,e,o,s;i&&(f=t.e.toLowerCase().indexOf(" in "),e=null,f!==-1&&(e=t.e.substring(0,f).trim(),t.e=t.e.substring(f+4)));o=c(t);s=!!t.p.once;try{r=n.eval("((function() { return function(__scope, event) { "+(u?"try { ":"")+" return "+o+";"+(u?" } catch (e) { return ''; }":"")+" }; })())");s||t.p["in-only"]||(r.i=eval("(function(__scope, __value) {"+(u?"try { ":" ")+o+" = __value; "+(u?"} catch (e) {}":"")+" })"))}catch(h){console.error(new Error("The expression {"+t.e+"} could not be parsed. "+h.message));r=function(){return"[error]"}}return r.o=s,r.b=!t.p["no-bind"],e&&(r.v=e),r},v=function(n){for(var i={e:"",p:{}},t=null,u=null,r=0;r<n.length;r++)t=n[r],u=r===n.length-1?"":" + ",t.v?i.e+="'"+t.v+"'"+u:t.e?i.e+=t.e+u:r===0&&(i.p=t.p);return i.p["in-only"]=!0,i},y=function(n,t){var i={};return n.p.c.splice(n.p.c.indexOf(n)+t,0,i),i};i.parse=function(n){var t=0,r=null,u=null,i=a(n.v);if(n.k)n.e=o(i.length===1?i[0]:v(i),n.k.n==="foreach");else for(t=0;t<i.length;t++)u=t===0?n:y(n,t),r=i[t],r.e?u.e=o(r):u.v=r.v;n.e&&(n.v="")};i.parseAll=function(n){if(n.length>0){for(var t=0;t<n.length;t++)i.parse(n[t]);n.removeAll()}};i.isExpression=function(n){return!!n&&n.indexOf("{")!==-1&&n.indexOf("}")!==-1}},b,k,s,h;expressions=new ot;b=function(n){var r=this,i={c:[],a:[],b:[],t:[],e:{e:[],r:[],d:[]}},c={update:!0,evaluate:!0,render:!0,dispose:!0},l={evaluate:!0,dispose:!0},e=function(n){n.s=n.n.toJsName()},u=function(t,r,f,e){var a=[r],h,v,o,s;if(f||(f=i),t.services)for(h=0;h<t.services.length;h++){if(v=t.services[h].toLowerCase(),o=n.services[v],!o)throw new Error("Service '"+t.services[h]+"' injected into '"+t.name+"' could not be resolved.");s={on:function(n,t){n=n.toLowerCase();l[n]&&(o.isSingleton?i:f).e[n.charAt(0)].push(t)}};v==="localization"&&(s.module=t.module);o.isSingleton?(o.i||(u(o,s,i),o.i=s),a.push(o.i)):(u(o,s,f),a.push(s))}r.element&&(r.on=function(n,t){if(n=n.toLowerCase(),c[n]){var i=n.charAt(0);i==="u"?e&&(e.u=t):f.e[i].push(t)}},r.on.module=t.module,r.raiseEvent=r.element.raiseEvent);t.initialize.apply(n,a)},s=function(n,t,i){if(!n.k.x||n.k.x.expressionsOnly&&!n.e)if(n.e){var r=n.e(i.s),u={e:t,v:r,n:n,p:i};n.e.o||i.a.push(u);t.setAttribute(n.k.n,r)}else t.setAttribute(n.k.n,n.v)},a=function(n,t){return function(i){n(t,i);r.update()}},o=function(n){for(var t=0;t<n.e.r.length;t++)n.e.r[t]()},f=function(n,i,r,h){for(var g=0,v=0,nt=null,c=null,d=null,b=null,k=null,p=null,l,it,ft,tt,w,rt,ut,g=0;g<i.c.length;g++){if(l=i.c[g],i.c[g].k){if(l.a.length>0&&l.a[0].k.x&&l.a[0].k.x.controlsContent){c=l.a[0];it=t.createComment("");ft=n.childNodes.length;n.insertAt(it,h);tt={element:n,insertAt:it,template:l.k.x?l.k.x.template:l,current:c};c.k.s||e(c.k);c.e?(b=c.e(r.s),k={s:{s:tt,p:r},e:c.e,k:c.k,v:b},c.e.o||r.b.push(k),tt[c.k.s]=b):tt[c.k.s]=c.v;u(c.k.x,tt,r,k);h+=n.childNodes.length-ft;continue}for(w=t.createElement(l.k.n),n.insertAt(w,h),v=0;v<l.e.length;v++)rt=l.e[v],w.addEventListener(rt.k.n,a(rt.e,r.s));if(l.k.x)for(l.k.x.template||(l.k.x.template={k:l.k,a:[],e:[],c:[]},l.k.x.expressions=[]),expressions.parseAll(l.k.x.expressions),p={c:[],a:[],b:[],t:[],p:r,s:{element:w},e:{e:[],r:[],d:[]}},l.k.x.at&&y&&y(p.s),w.resonate=p,v=0;v<l.a.length;v++)c=l.a[v],c.k.s||e(c.k),c.k.u||c.e&&!c.e.b?s(c,w,r):c.e?(b=c.e(r.s),c.e.o||p.b.push({e:c.e,v:b,k:c.k}),p.s[c.k.s]=c.e(r.s)):p.s[c.k.s]=c.v;else for(w.resonate=r,v=0;v<l.a.length;v++)s(l.a[v],w,r);for(v=0;v<l.a.length;v++)c=l.a[v],c.k.s||e(c.k),!c.k.x||c.k.x.expressionsOnly&&!c.e||(d={element:w},c.e?(b=c.e(r.s),k={e:w,v:b,n:c,p:r,s:d},c.e.o?d.once=!0:r.a.push(k),d[c.k.s]=b):(k=null,d[c.k.s]=c.v),u(c.k.x,d,r,k));l.k.x?(u(l.k.x,p.s,p,p),r.c.push(p),l.k.x.type===1&&l.c.length>0&&(p.x=l.c),f(w,l.k.x.template,p,0),o(p)):f(w,l,r,0)}else l.e?(b=l.e(r.s),nt=t.createTextNode(b),ut={t:nt,v:b,n:l,p:r},nt.resonate=ut,l.e.o||r.t.push(ut)):nt=t.createTextNode(l.v),n.insertAt(nt,h);h++}},h=function(n){for(var t=0,i=null,r,t=0;t<n.c.length;t++)h(n.c[t]);for(t=0;t<n.b.length;t++)current=n.b[t],current.e.i&&(i=current.s?current.s:n,r=current.k.x||!n.p.s?n.s:n.p.s,current.v!==i.s[current.k.s]&&(current.e.i(r,i.s[current.k.s]),current.v=i.s[current.k.s]));for(t=0;t<n.a.length;t++)current=n.a[t],current.s&&current.n.e.i&&current.v!==current.s[current.n.k.s]&&(current.n.e.i(n.s,current.s[current.n.k.s]),current.v=current.s[current.n.k.s])};r.update=function(n){n||(n=i,h(n));for(var u=0,t=null,f=null,o=!1,e=null,u=0;u<n.b.length;u++)t=n.b[u],e=t.s?t.s:n,f=t.e(e.p.s),t.v!==f&&(e.s[t.k.s]=f,t.v=f,o=!0,t.u&&t.u());for(u=0;u<n.t.length;u++)t=n.t[u],f=t.n.e(n.s),f!==t.v&&(t.t.nodeValue=f,t.v=f);for(u=0;u<n.a.length;u++)t=n.a[u],f=t.n.e(n.s),f!==t.v&&(t.v=f,t.s?t.s[t.n.k.s]=f:t.e.setAttribute(t.n.k.n,f),t.u&&t.u());for(u=0;u<n.e.e.length;u++)n.e.e[u]();for(u=0;u<n.c.length;u++)r.update(n.c[u]);o&&n.u&&n.u()};r.renderInitial=function(){var e=[],s=p.parseNode(t.body,e);expressions.parseAll(e);t.body.empty();n.components["@body"]&&(i.s={element:t.body},u(n.components["@body"],i.s,i,i));f(t.body,s,i,0);o(i);r.update()};r.createService=function(n,t){var i=null;return u({name:"dynamic:"+n,module:t,services:[n],initialize:function(n,t){i=t}},{}),i};r.render=f;r.setRendered=o;n.refresh=r.update};k=function(){var i=this;i.start=function(){t.write('<style id="rsld">body {visibility:hidden !important;}<\/style>');o=new et(i);e=new b(i);var r=function(){return new Promise(function(t){var i=d(function(){document.readyState!=="loading"&&(n.defer||nt(e.update),g(i),t())},1)})},u=function(){e.renderInitial();var n=t.getElementById("rsld");n.disabled=!0;n.parentNode.removeChild(n)};o.loadInitial().then(function(){r().then(function(){o.autoMode&&u()})});i.initialize=function(){r().then(u)}}};n.resonate=new k;n.resonate.start();resonate.inModule("Resonate").createComponent("content").with("Content").as(function(n,t){var i=n.element.resonate.p,r=i.x;r&&t.insert(n.element,r,0,i.p.s)});resonate.inModule("Resonate").createComponent("view").as(function(n){w(n)});resonate.inModule("Resonate").createAttribute("checked").forExpressions().as(function(n){var i=n.element,r=i.tagName.toLowerCase(),u=function(){var u,r,e,f,o;if(n.checked=i.checked,i.type.toLowerCase()==="radio"&&i.name)for(u=t.getElementsByName(i.name),r=0;r<u.length;r++)if(u[r].type.toLowerCase()==="radio"&&u[r]!==i)for(e=u[r].resonate.a,f=0;f<e.length;f++)o=e[f],o.e===u[r]&&(o.s.checked=!1);resonate.refresh()};if(r==="input")i.on("change",u);i.checked=n.checked;n.on("update",function(){i.checked!==n.checked&&(i.checked=n.checked)})});resonate.inModule("Resonate").createAttribute("class").forExpressions().as(function(n){var t=function(t){n.element.className=t};if(typeof n.class=="string"){n.on("update",function(){t(n.class)});t(n.class)}else{var i={},r=0,u=function(r){var o;i={};var f="",u=null,e=!1;for(o=0;o<r.length;o++)u=r[o],e=n.class[u],u.toLowerCase()==="defaults"?f+=e.replace(/,/g," ")+" "+f:e&&(f+=u+" "),i[u]=e;t(f)},f=function(){var t=Object.keys(n.class),e=null,f;if(r===t.length){for(f=0;f<t.length;f++)if(e=t[f],i[e]!==n.class[e]){u(t);break}}else u(t);r=t.length};if(!n.once)n.on("evaluate",f);f()}});resonate.inModule("Resonate").createAttribute("content").toControlContent().with("Content").as(function(n,t){var i=n.element.resonate,r;i.x&&(r=t.createContentTemplate(n.template),r.c=i.x,t.insert(n.element,r,n.insertAt.getIndex()+1,i.p.s))});resonate.inModule("Resonate").createAttribute("disabled").forExpressions().as(function(n){var t=n.element,i=function(){n.disabled?t.setAttribute("disabled",""):t.removeAttribute("disabled")};n.on("update",i);i()});resonate.inModule("Resonate").createAttribute("exclude").toControlContent().with("Content").as(function(n,t){var u=t.createContentTemplate(n.template),i=!0,r=function(){parseBool(n.exclude)?i||(t.remove(n.element.childNodes[n.insertAt.getIndex()+1]),i=!0):i&&(t.insert(n.element,u,n.insertAt.getIndex()+1),i=!1)};n.on("update",r);r()});resonate.inModule("Resonate").createAttribute("foreach").toControlContent().with("Content").as(function(n,t){var c=n.current.e.v;if(!c)throw new Error('The foreach expression was invalid. It should be structured like foreach="{itemName in itemsArray}".');var b=t.createContentTemplate(n.template),o=null,s=n.element,u=null,e=null,l=null,a=null,r=null,h=[],f=[],v=0,i=0,y=n.insertAt,k=function(){var n=[];for(i=0;i<f.length;i++)n.push(f[i].resonate.s[c]);return n},p=function(n,i,r){var u=Object.create(s.resonate.s);return u[c]=n,u.$index=i,t.insert(s,b,r,u),n=s.childNodes[r],f.push(n),n},w=function(){for(u=f,v=y.getIndex(),h=n.foreach,e=[],o&&o.cancel(),i=0;i<u.length;i++)t.remove(u[i],!0),e.push(u[i]);for(u=null,f=[],o=h.track(k),i=0;i<h.length;i++)p(h[i],i,i+v+1);t.cleanup(e)},d=function(){var k,w,g;if(o&&(k=o.changes(f,c),k)){v=y.getIndex();l=k.indexes;a=k.deleted;u=f;f=[];e=[];var d=0,b=0,n=y;for(i=0;i<a.length;i++)r=u[a[i]],t.remove(r,!0),e.push(r);for(i=0;i<l.length;i++)if(b=l[i],r=u[b],b<0||!r)n=p(h[i],i,v+i+1),d--;else{if(b-i-d!=0&&r!==n.nextSibling)n=s.insertBefore(r,n.nextSibling);else{for(w=n.nextSibling;w&&w!==r;)g=w.nextSibling,s.removeChild(w),w=g;n=r}r.resonate.s.$index=i;u[b]=null;f.push(r)}t.cleanup(e);u=null;a=null;l=null;r=null}};if(!n.once)n.on("evaluate",d);n.on("update",w);w()});resonate.inModule("Resonate").createAttribute("hide").as(function(n){var t=function(){n.element.style.display=parseBool(n.hide)?"none":""};n.on("update",t);t()});resonate.inModule("Resonate").createAttribute("href").with("Routing").as(function(n,t){var r=n.element,i=n.href.replace(/~/g,"");if(n.href.indexOf("~")===0)n.element.on("click",function(n){return n.stopPropagation(),n.preventDefault(),t.changeRoute(i),!1});r.setAttribute("href",i)});resonate.inModule("Resonate").createAttribute("html").as(function(n){var t=function(){n.element.innerHTML=n.html};n.on("update",t);t()});resonate.inModule("Resonate").createAttribute("include").toControlContent().with("Content").as(function(n,t){var u=t.createContentTemplate(n.template),i=!1,r=function(){parseBool(n.include)?i||(t.insert(n.element,u,n.insertAt.getIndex()+1),i=!0):i&&(t.remove(n.element.childNodes[n.insertAt.getIndex()+1]),i=!1)};n.on("update",r);r()});s=function(n,t){n.on("render",function(){try{n.module=n.element.resonate.s.on.module}catch(i){}n.module||(n.module=resonate.modules.resonate);t()});u.subscribers.push(t);n.on("update",t);n.on("dispose",function(){u.subscribers.remove(t)})};resonate.inModule("Resonate").createAttribute("localize").as(function(n){var i=null;s(n,function(){var u=n.localize,r=n.module.localization[u];r||(r=u);i?i.nodeValue=r:(i=t.createTextNode(r),n.element.appendChild(i))})});resonate.inModule("Resonate").createAttribute("localize-html").as(function(n){s(n,function(){var t=n.localizeHtml,i=n.module.localization[t];n.element.innerHTML=i?i:t})});resonate.inModule("Resonate").createAttribute("localize-title").as(function(n){s(n,function(){var t=n.localizeTitle,i=n.module.localization[t];n.element.title=i?i:t})});resonate.inModule("Resonate").createAttribute("localize-placeholder").as(function(n){s(n,function(){var t=n.localizePlaceholder,i=n.module.localization[t];n.element.placeholder=i?i:t})});resonate.inModule("Resonate").createAttribute("show").as(function(n){var t=function(){n.element.style.display=parseBool(n.show)?"":"none"};n.on("update",t);t()});h={};resonate.inModule("Resonate").createAttribute("style").forExpressions().as(function(n){var i,t,r;if(typeof n.style=="string"){i=function(){for(var t,r=n.style.split(";"),i=0;i<r.length;i++)t=r[i].split(":"),t.length===2&&(n.element.style[t[0].trim()]=t[1].trim())};n.on("update",i);i()}else{if(t={},r=function(){var i=0,r=null,o=n.element.style,s=n.style.defaults,e,f,u;if(s){for(e=s.split(";"),i=0;i<e.length;i++)f=e[i].split(":"),f.length!==2||n.style[f[0]]||(n.style[f[0]]=f[1]);delete n.style.defaults}for(u=Object.keys(t),i=0;i<u.length;i++)r=u[i],n.style.hasOwnProperty(r)||(o[h[r]]="",delete t[r]);for(u=Object.keys(n.style),i=0;i<u.length;i++)r=u[i],value=n.style[r],t[r]!==value&&(h[r]||(h[r]=r.toJsName()),o[h[r]]=value,t[r]=value)},!n.once)n.on("evaluate",r);r()}});resonate.inModule("Resonate").createAttribute("value").forExpressions().as(function(n){var t=n.element,i=t.tagName.toLowerCase(),r=function(){n.value=t.value;resonate.refresh()};if(i==="select")n.on("render",function(){t.value=n.value;t.on("change",r)});else if(t.value=n.value,i==="textarea"||i==="input")t.on("input",r);n.on("update",function(){t.value!==n.value&&(t.value=n.value)})});resonate.inModule("Resonate").createService("Content").asSingleton(function(t){var i=function(n){for(delete n.resonate;n.childNodes.length>0;){var t=n.childNodes[0];i(t);n.removeChild(t)}},f=function(n){for(var i=Object.keys(n),t=0;t<i.length;t++)n[i[t]]=null,delete n[i[t]]},u=function(n,t){for(var i=0,r,i=0;i<n.e.d.length;i++)n.e.d[i]();for(i=0;i<n.c.length;i++)u(n.c[i],t);for(r=[n.c,n.a,n.b,n.t,n.e.e,n.e.r,n.e.d],i=0;i<r.length;i++)r[i].removeAll();n.s!==t.s&&f(n.s);delete n.p;delete n.u;delete n.s};t.cleanup=function(t){n.defer(function(){for(var r,n=0;n<t.length;n++)r=t[n].resonate,i(t[n]),r&&u(r,r.p);t.splice(0,t.length)})};t.replace=function(n,i){var r=n.parentElement,u=n.getIndex();t.remove(n);t.insert(r,i,u)};t.remove=function(n,t){var r=n.resonate,f=n.parentElement;if(!r.d&&r.p&&r.p.d&&(r=r.p),r.d)r.p.c.remove(r),f&&f.removeChild(n),t||(i(n),u(r,r.p));else throw new Error("Only content added dynamically can be removed.");};t.insert=function(n,t,i,u){var s,h,f,o;typeof t=="string"&&(s=[],r.innerHTML="<div>"+t+"<\/div>",h=r.content?r.content:r,t=p.parseNode(h.children[0],s).c,expressions.parseAll(s),r.innerHTML="");f=n.resonate;o={c:[],a:[],b:[],t:[],d:!0,p:f,s:u?u:f.s,e:{e:[],r:[],d:[]}};f.c.push(o);e.render(n,{c:t.push?t:[t]},o,i);e.setRendered(o)};t.createContentTemplate=function(n){for(var r=[],t=null,i=0;i<n.a.length;i++)t=n.a[i],t.k.x&&t.k.x.controlsContent||r.push(t);return{k:n.k,a:r,e:n.e,c:n.c}}});resonate.inModule("Resonate").createService("Expressions").asSingleton(function(){});resonate.expressions=e.createService("Expressions",resonate.modules.resonate);resonate.inModule("Resonate").createService("HTTP").asSingleton(function(n){var t=function(n){var t={request:n,status:n.status,headers:{}},r,i,u,f;try{t.response=JSON.parse(n.responseText)}catch(e){t.response=n.responseText}for(r=n.getAllResponseHeaders().trim().split(/[\r\n]+/),i=0;i<r.length;i++)u=r[i].split(": "),f=u.shift(),t.headers[f]=u.join(": ");return t},i=function(n,i,r,u){return new Promise(function(f,e){var o=new XMLHttpRequest,c="addEventListener",a=function(){(o.status<400?f:e)(t(o))},l=function(){e(t(o))},h,s;if(o[c]("load",a),o[c]("error",l),o[c]("aborts",l),o.open(n,i),n==="POST"&&o.setRequestHeader("Content-Type","application/json;charset=UTF-8"),r)for(h=Object.keys(r),s=0;s<h.length;s++)o.setRequestHeader(h[s],r[h[s]]);o.send(u?JSON.stringify(u):null)})};n.get=function(n,t){return i("GET",n,t)};n.post=function(n,t,r){return i("POST",n,r,t)}});resonate.inModule("Resonate").createService("Localization").asTransient(function(n){n.module||(n.module=resonate.modules.resonate);n.localize=function(t,i){i?typeof i=="string"&&(i=resonate.modules[i.toLowerCase()]):i=n.module;var r=i.localization[t];return r?r:t};n.changeLocale=u.changeLocale;n.getLocale=u.getLocale;n.onLocaleChange=function(n){u.subscribers.push(n)};n.unbindLocaleChange=function(n){u.subscribers.remove(n)}});resonate.inModule("Resonate").createService("Routing").with("Content").asSingleton(function(i,r){var s=null,d=resonate.routes,u={route:"",data:{},view:{}},h={},c=!history.pushState||v==="hashes",e=t.location,a={},p=null,b;y=function(n){n.routeData=u.data;n.location=u.route};b=function(n){history.replaceState?history.replaceState({},"",n):e.href=n};c&&!e.hash&&(f?b("/"+f+"/#"+e.pathname.replace("/"+f,"")+e.search):b("/#"+e.pathname+e.search));t.t&&history.replaceState({route:t.t,data:{}},"",t.t);var k=function(n,t,i,r){var s=t.length===r+1,c=t[r],e=n[c.toLowerCase()],f,u,o;if(e){if(s){i.view=e["@@"];return}k(e,t,i,r+1)}else for(f=0;f<n["!!"].length;f++)if(u=n["!!"][f],s&&u.routes["@@"]?i.view=u.routes["@@"]:k(u.routes,t,i,r+1),i.view){o=u.name.toJsName();h[o]=!0;i.data[o]=c;break}},g=function(n){h={};var t={data:n.data};return k(d,n.route.split("/"),t,1),t.view},nt=function(n){var u={},r,t,i;if(n)for(n.charAt(0)==="?"&&(n=n.substring(1)),r=n.split("&"),t=0;t<r.length;t++)i=r[t].split("="),i.length===2&&(u[i[0]]=i[1]);return u},tt=function(){var i=decodeURI(e.search),n=decodeURI(e.pathname),r=decodeURI(e.hash),t;return r&&(t=r.split("?"),n=t[0].replace("#",""),i=t.length>0?t[1]:""),f&&(n=n.replace("/"+f,"")),n===""&&(n="/"),{data:nt(i),route:n}},ft=function(n){for(var t=0,i=[],t=0;t<n.routes.length;t++)i.push(new RegExp("^"+n.routes[t].replace(/\*/g,".*")+"$"));n.containsRoute=function(n){for(t=0;t<i.length;t++)if(i[t].test(n))return!0;return!1}},et=function(n){for(var t,i=0;i<resonate.areas.length;i++)if(t=resonate.areas[i],t.containsRoute||ft(t),t.containsRoute(n.route))return o.loadModules(t.modules).then(function(){it(g(n),n)}),!0;return!1},it=function(n,i){if(n||(n=d["@routing-error"]),n)u.route=i.route,u.data=i.data,u.view=n,ut(Object.keys(u.data)),t.body.scrollTop=t.documentElement.scrollTop=0,s.children.length>0?r.replace(s.children[0],u.view.template,0):r.insert(s,u.view.template,0),p=s.children[0].resonate.u,resonate.refresh();else throw new Error("The route '"+i.route+"' could not be resolved to a view.");},l=function(n){if(n.route!==u.route){var t=g(n);if(!t&&et(n))return;it(t,n)}else p&&p()},ot=function(){l(tt())},rt=function(n,t){var i="",u=Object.keys(t),r,o,s;if(u.length>0){for(i="",r=0;r<u.length;r++)h[u[r]]||(i+=""+u[r]+"="+t[u[r]]+"&");i.length>0&&(i="?"+i.substring(0,i.length-1))}o=(f?"/"+f:"")+(c?"/#":"")+n+i;c?e.href=o:(s={route:n,data:t},l(s),history.pushState(s,"",o))},ut=function(n){a={};for(var t=0;t<n.length;t++)a[n[t]]=u.data[n[t]]};w=function(t){if(s)throw new Error("Only one view element is permitted");s=t.element;var i=tt();l(i);c?n.addEventListener("hashchange",ot):(history.replaceState(i,""),n.addEventListener("popstate",function(n){l(n.state)}))};i.getCurrentData=function(){return u.data};i.getCurrentView=function(){return u.view.name};i.getCurrentRoute=function(){return u.route};i.changeRoute=function(n,t){if(n=decodeURI(n),!t){var i=n.split("?");n=i[0];t=nt(i[1])}rt(n,t)};i.on("evaluate",function(){for(var n=Object.keys(u.data),t=0;t<n.length;t++)if(!h[n[t]]&&u.data[n[t]]!==a[n[t]]){ut(n);rt(u.route,u.data);break}})});resonate.inModule("Resonate").createExpression("localize").with("Localization").as(function(n){return function(t,i){return n.localize(i,t.on.module)}});resonate.inModule("Resonate").createExpression("currentView").with("Routing").as(function(n){return n.getCurrentView});resonate.inModule("Resonate").createExpression("currentRoute").with("Routing").as(function(n){return n.getCurrentRoute});resonate.inModule("Resonate").createExpression("currentRouteData").with("Routing").as(function(n){return n.getCurrentData});resonate.inModule("Resonate").createExpression("changeRoute").with("Routing").as(function(n){return n.changeRoute})})(window);