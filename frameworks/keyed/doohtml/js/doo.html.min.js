!function(t){var e={};function i(a){if(e[a])return e[a].exports;var o=e[a]={i:a,l:!1,exports:{}};return t[a].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=t,i.c=e,i.d=function(t,e,a){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(a,o,function(e){return t[e]}.bind(null,o));return a},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=2)}([function(t,e,i){"use strict";i.r(e);const a={dataSet:{},setData:function(t,e,i=null){if(t=this.getDataSetName(t),this.dataSet[t]=e,Doo.debug&&i){if(!localStorage.getItem("Doo")){let t={};localStorage.setItem("Doo",JSON.stringify(t))}const e=JSON.parse(localStorage.getItem("Doo"));e[i+"_"+t]=this.dataSet[t],localStorage.setItem("Doo",JSON.stringify(e))}},getData:function(t){return t=this.getDataSetName(t),this.dataSet[t]},getDataSetName:function(t){return t&&"object"==typeof t&&(t=Doo.getDataBind(t)),t?(this.dataSet[t]||(this.dataSet[t]=[]),t):(console.log("No dataSet name specified."),null)},prepend:function(t,e){t=this.getDataSetName(t),this.append(t,e,!0)},append:async function(t,e,i=null){Array.isArray(e)?this.dataSet[t]=i?e.concat(Doo.DAO.getData(t)):Doo.DAO.getData(t).concat(e):(t=this.getDataSetName(t),i?Doo.DAO.getData(t).splice(0,0,e):Doo.DAO.getData(t).push(e)),this.refresh(t)},update:function(t,e,i){t=this.getDataSetName(t),Doo.DAO.getData(t).splice(i,1,e),this.refresh(t)},remove:function(t,e){t=this.getDataSetName(t),Doo.DAO.getData(t).splice(e,1),this.refresh(t)},refresh:async function(t,e=document){const i=e.querySelectorAll("[doo-dispatch='"+t+"']");for(let t=0,e=i.length;t<e;t++)await i.item(t).render()},csvToJson:function(t){let e=t.split("\n"),i=[];if(void 0!==e){let t=e.length,a=e[0].replace(/\r/g,"").split(","),o=a.length;if(e.length>1){let r=new RegExp('(,)(?=(?:[^"]|"[^"]*")*$)',"g");for(let s=1;s<t-1;s++){let t={},l=(e[s].replace(r,"|^|")+"|^|").split("|^|");for(let e=0;e<o;e++)t[a[e]]=l[e]?l[e].replace(/"/g,"").trim():"";i.push(t)}}}return i}};e.default=a},function(t,e,i){"use strict";i.r(e);const a={getStyle:(t,e,i=null)=>t.currentStyle?t.currentStyle[e]:window.getComputedStyle(t,i).getPropertyValue(e),sortBy:(t,e,i)=>{if(t.length<1)return;const a={getValue:(t,e)=>{for(var i=e.split("."),a=t,o=0;o<i.length;o++)a=a[i[o]];return a},getDataType:function(t,e){if("object"==typeof t)return"byFunc";var i=a.getValue(e[0],t);if(i&&i.toString().indexOf("/")>0&&new Date(i)&&!isNaN(new Date(i).getTime()))return"byDate";for(var o=0;o<e.length;o++)if(isNaN(a.getValue(e[o],t)))return"byString";return"byNumber"},byFunc:function(t,e,o,r){var s=o[r].cmd,l=s.call(this,-1===o[r].dir?e:t,o[r].param,i),n=s.call(this,-1===o[r].dir?t:e,o[r].param,i);return l<n?-1:l>n?1:void 0!==o[r+1]?a[o[r+1].type](t,e,o,r+1):t.$_id-e.$_id},byDate:function(t,e,i,o){var r=i[o].fld.replace(Doo.$Config.DELIMITER.BEG,"").replace(Doo.$Config.DELIMITER.END,""),s=a.getValue(-1===i[o].dir?e:t,r),l=a.getValue(-1===i[o].dir?t:e,r);return s.getTime||l.getTime||(s=new Date(s),l=new Date(l)),(s=s.getTime())<(l=l.getTime())?-1:s>l?1:void 0!==i[o+1]?a[i[o+1].type](t,e,i,o+1):t.$_id-e.$_id},byString:function(t,e,i,o){var r=i[o].fld.replace(Doo.$Config.DELIMITER.BEG,"").replace(Doo.$Config.DELIMITER.END,""),s=a.getValue(-1===i[o].dir?e:t,r).toUpperCase(),l=a.getValue(-1===i[o].dir?t:e,r).toUpperCase();return s<l?-1:s>l?1:void 0!==i[o+1]?a[i[o+1].type](t,e,i,o+1):t.$_id-e.$_id},byNumber:function(t,e,i,o){var r=i[o].fld.replace(Doo.$Config.DELIMITER.BEG,"").replace(Doo.$Config.DELIMITER.END,""),s=Number(a.getValue(-1===i[o].dir?e:t,r)),l=Number(a.getValue(-1===i[o].dir?t:e,r));return s<l?-1:s>l?1:void 0!==i[o+1]?a[i[o+1].type](t,e,i,o+1):t.$_id-e.$_id}};var o=[];if("string"==typeof e&&(e=[e=e.replace("{{","").replace("}}",""),i||1]),e)for(var r=0;r<e.length;r+=2)o.push({fld:e[r],dir:Number(e[r+1]||1),type:a.getDataType(e[r],t)});if(t.length>0&&void 0===typeof t[0].$_id){Timer.start("makeids");for(let e=0,i=t.length;e<i;e++)t[e].$_id=Number(e);Timer.stop("makeids",!0)}t.sort((function(t,e){return a[o[0].type](t,e,o,0)}))},curTop:(t,e)=>{let i=0;if(t.offsetParent)for(;t&&(i+=t.offsetTop,!e||"absolute"!==(void 0).getStyle(t,"position"));)t=t.offsetParent;else t.y&&(i+=t.y);return i}};e.default=a},function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"default",(function(){return Doo}));var _doo_dao_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(0),_doo_util_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1);
/*!
 * doo.html.min.js
 * ===============
 * JavaScript WebComponent Framework
 *
 * http://github.com/hman61/doo-html
 * MIT License, Â© Henrik Javen 2019-2021
 * ver. 0.70.2
 */
window.isReady={};class Doo extends HTMLElement{static get $Doo(){return{instance:{},counter:{},getNextID:function(t){return void 0===Doo.$Doo.counter[t]&&(Doo.$Doo.counter[t]=-1),t+"_"+ ++Doo.$Doo.counter[t]}}}static get version(){return"v0.70.2"}constructor(t=50){super(),Doo.debug=location.href.includes("#debug")||!1,Doo.DAO=_doo_dao_js__WEBPACK_IMPORTED_MODULE_0__.default,Doo.util=_doo_util_js__WEBPACK_IMPORTED_MODULE_1__.default,this.debug=Doo.debug,this.initialTime=(new Date).getTime(),this.PAGE_SIZE=t,!this.template&&this.getAttribute("template")&&(this.template=this.template||this.getAttribute("template")),this.filteredData={},this.visibleColumns=[],this.place=[],this.scrollPos=0,this.debug&&console.log(Doo.$Config.NAME+" "+Doo.version)}find(t){let e=t.target.value.trim().length?t.target.value.trim():"",i=this.data[this.defaultDataSet]&&this.data[this.defaultDataSet].length>1e3?700:e.length>3?1:500;"deleteContentBackward"===t.inputType&&(i=700),this.filterTimeoutID&&clearTimeout(this.filterTimeoutID),this.filterTimeoutID=setTimeout(()=>{this.filterKey=e,this.setDataFilter(this.defaultDataSet),this.clearChildren(),this.render(),this.container&&(this.container.scrollTop=0)},i)}getDooParent(){if(this.shadow.host){let t=this.shadow.host;for(;t.parentNode;){if(t.parentNode.host)return t.parentNode.host;t=t.parentNode}}return null}static getDataBind(t){for(;t.parentNode;){if(t.hasAttribute(Doo.$Config.DATA_BIND))return t.getAttribute(Doo.$Config.DATA_BIND);t=t.parentNode}}static get $Config(){return Object.freeze({DATA_BIND:"bind",TEMPLATE_EXT:".html",COMPONENT_DIR:"/components",NAME:"Doo.HTML",TYPE:{DEFAULT:0,ENUM:1,DEEP:2,COMPUTED:3},MATCH:{ANY:-1,STARTS_WITH:0,EXACT:1},DELIMITER:{BEG:"{{",END:"}}"},DOCUMENT:"document",SHADOW:"shadow",FLEX_BODY:".fbody"})}static get $Computed(){return{randomImg:()=>"https://source.unsplash.com/random/720x400",childDoodad:t=>t.instance.injectChild(t.name,t.props),currentItem:t=>t.item.address,$0:t=>t.item[t.props[0]],$1:t=>t.item[t.props[1]],$2:t=>t.item[t.props[2]],greyShade:t=>["light-grey","grey","dark-grey","black"][t.i%4],randomTailwindShade:t=>100*Math.random(t.i%8+1),fraction:t=>["","whole","half","third","quarter","fifth"][t.arr.length],toUpperCase:t=>t.getValue().toUpperCase(),toLowerCase:t=>t.getValue().toLowerCase(),substring:t=>t.getValue().substring(t.$1,t.$2),length:t=>t.arr.length,found:t=>t.instance.getCurrentData(t.$1).length,count:t=>t.instance.data[t.$1].length,recCountByDataSetKey:t=>t.klass[t.dataSetKey].length,i:t=>t.i,row:t=>t.i+1,$id:t=>"_$"+t.i,n:t=>t.i+1,ts:()=>(new Date).getTime(),pluralize:t=>t.arr.length>1?"s":"",nbsp:()=>"&nbsp;",zeroOne:t=>t.i%2,lorem:t=>{let e="Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.";if(!isNaN(t.$1)){let i=Math.min(t.$1,6);for(let t=1;t<i;t++)e+=" Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat."}return e},content:t=>t.$1,html:t=>t.$1,dooReflect:t=>{let e=Doo.$Doo.instance[t.instance.getAttribute("id")].dataMap[t.i].split(":");return e.length>1?e[1]:e[0]},dooFlex:t=>{let e=Doo.$Doo.instance[t.instance.getAttribute("id")].flex;e=e[t.i];let i="";return e.includes(":")&&(i=e.split(":").length>2?"doo-center":"doo-end",e=e.replace(/:/g,"")),"doo-flex doo-"+e+" "+i},dooSort:t=>{let e=Doo.$Doo.instance[t.instance.getAttribute("id")].dataMap[t.i].split(":"),i=e[0].includes("(")?t.instance.getAttribute("id")+"."+e[0]:"'"+e[0]+"'",a=t.instance.getAttribute("id").split("_");return`${a[0]}[${a[1]}].sortBy(this,${i})`},dynamic:t=>Doo.$Config.DELIMITER.BEG+t.item+Doo.$Config.DELIMITER.END}}highlight(t){let e=this.filterKey&&this.filterKey.toLowerCase();if(!e||!t)return t;let i=new RegExp(e,"ig");return t.toString().replace(/&amp;/gi,"&").replace(i,t=>`<b class="doo-find">${t}</b>`)}static get observedAttributes(){return["doo-refresh","key","doo-foreach","orientation","doo-dao","doo-db-update","doo-db","page-size","debug"]}static xAttr(){return["src","selected","checked","disabled","readonly"]}dynamicField(t){return Doo.$Config.DELIMITER.BEG+t+Doo.$Config.DELIMITER.END}async attributeChangedCallback(t,e,i){i.length>0&&e!==i&&("doo-db-update"===t||"doo-refresh"===t?await this.render():"page-size"===t?this.PAGE_SIZE=i:"debug"===t&&(Doo.debug=!0))}static async insertRow(t,e){document.createElement("div").innerHTML=`<doo-html template="/doodads/row/row.${Doo.$Config.TEMPLATE_EXT}" data-fetch="${e}" bind="${t}"></doo-html>`}static async insertComponent(t,e,i="."){let a=(t=t.trim()).toLowerCase(),o=document.createElement("div");o.innerHTML=`<doo-${t} template="${i}/templates/${a}${Doo.$Config.TEMPLATE_EXT}?${Doo.$Computed.ts()}"></doo-${t}>`,document.querySelector(""+e).innerHTML=o.innerHTML}async initDooBind(){let t=document.querySelector("doo-bind"),e=t.querySelectorAll("data"),i=t.getAttribute("data-sheet-key"),a=[...e];for(let t in a){let e=a[t].getAttribute("name");if(!window.isReady[e]){let o=await this.getDataObj(a[t].getAttribute("data-fetch"),i);Doo.DAO.setData(e,o,this.constructor.name),window.isReady[e]=e}}t.innerHTML="",t.setAttribute("is-ready",!0)}async connectedCallback(){let t=this.getAttribute("context")||Doo.$Config.SHADOW;if(this.shadow=t===Doo.$Config.SHADOW?this.attachShadow({mode:"open"}):document,this.id||this.getDooParent()||(this.id=Doo.$Doo.getNextID(this.constructor.name)),!this.defaultDataSet&&this.getAttribute("bind")&&(this.defaultDataSet=this.getAttribute("bind")),Doo.$Doo.instance[this.id]||(Doo.$Doo.instance[this.id]=this),"function"==typeof this.init&&await this.init(),this.debug){let t=this.constructor.name.toLowerCase();console.log(`Custom tag added: <doo-${t} />`)}await this.render(),this.scrollTarget&&(this.scrollElem=this.shadow.querySelector(this.scrollTarget)),this.ready=!0,"function"==typeof this.dooAfterRender&&await this.dooAfterRender()}static define(t,e=null){let i=e||t.name.toLowerCase();customElements.define("doo-"+i,t)}getFilteredData(t){return this.filteredData[t]}async setTemplate(t,e){let i=0===t.indexOf("<template")?t:"";return i=this.firstElementChild&&this.firstElementChild.getElementsByTagName("template").length>0?this.firstElementChild.getElementsByTagName("template")[0].outerHTML:await this.getTemplateURI(t,e),i}async getTemplateURI(t){let e;return e=0===t.indexOf("#")?await document.querySelector(t).outerHTML:await Doo.fetchURL(t),e}dooParse(t){let e=t.cloneNode(!0);e.removeAttribute(Doo.$Config.DATA_BIND);let i=e.outerHTML.replace(/\t/g,"").replace(/\n/g,""),a=i;Doo.xAttr().forEach(t=>{i=i.replace(new RegExp(" "+t+'="{{(.+)}}"',"g")," doo-"+t+'="{{$1}}"')});let o=a===i;void 0===window[this.constructor.name]&&(window[this.constructor.name]=[]);let r=window[this.constructor.name].length;i=i.split('="doo.self.').join('="'+this.constructor.name+"["+r+"]."),i=i.split('="self.').join('="'+this.constructor.name+"["+r+"].");let s,l=i.split(Doo.$Config.DELIMITER.END),n=[],h=l.length;for(let t=0;t<h;t++)Doo.$Config.DELIMITER.BEG.includes(Doo.$Config.DELIMITER.BEG)&&(s=l[t].split(Doo.$Config.DELIMITER.BEG),n.push(s[0]),n.push(this.getPropertyType(s[1])));return{templateArray:n,xHtml:o}}htmlParse(t,e){let i=t.cloneNode(!0);i.removeAttribute(Doo.$Config.DATA_BIND),i.removeAttribute("data-src");let a=i.outerHTML.replace(/\t/g,"").replace(/\n/g,""),o=0,r=e.length;const s=(t,i)=>e[o][i.trim()];let l=[];for(o=0;o<r;o++)l.push(a.replace(/\{\{(.+?)\}\}/gm,s));return l.join("")}getPropertyType(t){if(!t)return new Doo.FieldType("",void 0,this.constructor,this);t=t.trim();let e=Doo.$Config.TYPE.DEFAULT;t.indexOf("(")>-1?e=Doo.$Config.TYPE.COMPUTED:t.indexOf(".")>0?e=Doo.$Config.TYPE.DEEP:isNaN(t)||(e=Doo.$Config.TYPE.ENUM);let i=new Doo.FieldType(t,e,this.constructor,this);return this.visibleColumns.push(t),i.parentElem=this.parentElement,i}setItemValue(t,e,i){let a=e.split(".");for(var o=0;o<a.length-1;o++)t=t[a[o]]={};t[a[a.length-1]]=i}getItemValue(t,e){if("function"==typeof e)return this.highlight(this[e](t));let i=t;try{e.split(".").forEach(t=>i=i[t])}catch(t){console.log("Property not found",e,JSON.stringify(i))}return this.highlight(i)}renderNode(t,e,i=0,a=this.PAGE_SIZE){let o=t.templateArray,r=t.xHtml,s=(e=Array.isArray(e)?e:[e]).length,l=i+a;l>s&&(l=s);let n=[];for(let t=i;t<l;t++)for(let i=0,a=o.length;i<a;i+=2){n.push(o[i]);let a=o[i+1];switch(a.type){case Doo.$Config.TYPE.DEFAULT:case Doo.$Config.TYPE.DEEP:n.push(this.getItemValue(e[t],a.fld));break;case Doo.$Config.TYPE.ENUM:this.filterKey?n.push(e[t]):n.push(this.highlight(e[t]));break;case Doo.$Config.TYPE.COMPUTED:let i=new Doo.DataItem(e[t],t,e);i.fld=a.fld,i.func=a.func,i.$1=a.$1,i.$2=a.$2,i.$3=a.$3,i.$4=a.$4,i.$5=a.$5,i.instance=a.instance,n.push(a.func(i));break;case void 0:n.push("")}}if(r)return n.join("");{let t=n.join("");return Doo.xAttr().forEach(e=>{"checked"!==e&&"disabled"!==e||(t=t.replace(new RegExp(" doo-"+e+'="false"',"g")," ").replace(new RegExp(" doo-"+e+'="0"',"g")," ")),t=t.replace(new RegExp(" doo-"+e+"=","g")," "+e+"=").replace(new RegExp(" "+e+'=""',"g")," ")}),t}}getLevel(t){let e=0;for(;t.parentElement;)t=t.parentElement,e++;return e}clearDataFilter(t){this.filteredData[t]=void 0}setDataFilter(t,e){let i=this.filterKey&&this.filterKey.toLowerCase(),a=this.data[t].slice(),o=this;e?a=a.filter(e):i&&(i=String(i),a=a.filter(t=>o.visibleColumns.some(e=>String(o.getItemValue(t,e)).toLowerCase().indexOf(i)>-1))),this.setScrollContainerHeight(a.length),this.filteredData[t]=a.slice(0,this.page_size)}async getDataObj(dataSrc,dataSheetKey=null){let data,key;if(dataSrc=dataSrc.trim(),dataSrc.indexOf(".csv")>-1)return data=await Doo.fetchURL(dataSrc),Doo.DAO.csvToJson(data);if(dataSheetKey&&dataSrc.indexOf("worksheet")>-1){let t=dataSrc.split("|");return data=await this.tableTop(dataSheetKey,t[1]),data}if(dataSrc.indexOf("worksheet")>-1&&dataSrc.indexOf("key")>-1){let t=dataSrc.split("|"),e=t[1],i=t[3];return data=await this.tableTop(e,i),data}if(0===dataSrc.indexOf("http")||dataSrc.indexOf(".json")>0)return data=await Doo.fetchURL(dataSrc),JSON.parse(data);if(dataSrc.indexOf(".js")>0)return data=await __webpack_require__(3)(""+dataSrc),data.default;if(0===dataSrc.indexOf("{"))return JSON.parse(dataSrc);if(0===dataSrc.indexOf("..")||"this.parent.data"===dataSrc){let t=this.getDooParent();return t.data}if(dataSrc.indexOf("..")>0){let t=dataSrc.replace("[","").replace("]",""),e=t.split(".."),i=[],a=isNaN(e[0]),o=parseInt(a?e[0].charCodeAt(0):e[0]),r=parseInt(a?e[1].charCodeAt(0):e[1]);for(let t=o;t<=r;t++)i.push(a?String.fromCharCode(t):t);return i.splice(0)}if(dataSrc.includes("|")||0===dataSrc.indexOf("[")){let t=dataSrc.includes("|")?"|":",",e=dataSrc.replace("[","").replace("]","").split(t);return e.forEach(t=>t.trim()),e}return 0===dataSrc.indexOf("window.")||0===dataSrc.indexOf("const.")||0===dataSrc.indexOf("var.")?(key=dataSrc.split(".")[1].trim(),window[key]):dataSrc.includes(" ")||void 0===typeof eval(dataSrc)?(console.log("WARNING: "+dataSrc+" datasource not scooped properly"),dataSrc):eval(dataSrc)}async initDataNodes(t){this.dataMap=null,this.flex=null,this.hasAttribute("data-map")&&(0===this.getAttribute("data-map").indexOf("Doo.reflect")?this.dataMap=Reflect.ownKeys(Doo.DAO.getData(this.getAttribute(Doo.$Config.DATA_BIND))[0]):this.dataMap=this.getAttribute("data-map").split("|")),this.hasAttribute("flex")&&(this.flex=this.getAttribute("flex").replace("[","").replace("]","").split("|"));let e=t.content.querySelectorAll('[data-src="${data-map}"]');e.length>0&&[...e].forEach(t=>{let e=[];this.dataMap.forEach((t,i)=>{let a=void 0===this.flex[i]?1:this.flex[i],o=t.split(":"),r=o.length>1?o[1]:o[0],s="";a.includes(":")&&(s=a.split(":").length>2?"doo-center":"doo-end",a=a.replace(/:/g,"")),e.push({label:r,fieldName:this.dynamicField(o[0]),flex:a,flexJustify:s})});let i=this.htmlParse(t,e),a=t.parentElement;a.removeChild(t),a.innerHTML=i+a.innerHTML}),t.innerHTML=t.innerHTML.replace(/\$\{(.+?)\}/gm,(e,i)=>isNaN(i)?this.hasAttribute(i)?this.getAttribute(i):t.hasAttribute(i)?t.getAttribute(i):"":this.dataMap.length>0?Doo.$Config.DELIMITER.BEG+this.dataMap[i-1]+Doo.$Config.DELIMITER.END:void 0),[...t.content.querySelectorAll("["+Doo.$Config.DATA_BIND+"]")].forEach(t=>{if(!t.hasAttribute("data-src")){let e=this.hasAttribute("doo-dispatch")?"Doo.DAO":"this.data";t.setAttribute("data-src",e)}});let i,a,o=t.content.querySelectorAll("[data-src]"),r=o.length,s=0,l=[];for(s=0;s<r;s++){let t=o[s].getAttribute(Doo.$Config.DATA_BIND).trim(),e=o[s].getAttribute("data-src").trim();e&&("Doo.DAO"===e?(this.setAttribute("doo-dispatch",t),a=Doo.DAO.getData(t)):a=await this.getDataObj(e,o[s]),this.data[t]=Array.isArray(a)?a:a[t]),0===e.indexOf("this.parent")&&(o[s].useParent=!0),o[s].removeAttribute("data-src"),o[s].level=this.getLevel(o[s]),l.push(o[s])}this.removeAttribute("data-map"),this.removeAttribute("flex"),this.removeAttribute("data-fetch");for(l.sort((t,e)=>t.level===e.level?0:t.level>e.level?1:-1).reverse(),s=0;s<r;s++){i="|STYLE|LINK|".indexOf(`|${l[s].tagName}|`)>-1?l[s]:l[s].parentElement&&("void"===o[s].getAttribute(Doo.$Config.DATA_BIND)||"|DL|UL|TBODY|THEAD|TFOOT|TR|SELECT|SECTION|".indexOf(`|${l[s].parentElement.tagName}|`)>-1)?l[s].parentElement:document.createElement("data"),i.dataKey=l[s].getAttribute(Doo.$Config.DATA_BIND);let t=this.dooParse(l[s],this.dataMap);i.templateArray=t.templateArray,i.xHtml=t.xHtml,i.name=s,i.level=this.getLevel(l[s]),i.useParent=l[s].useParent,i.noRepeat=l[s].hasAttribute("data-norepeat"),"DATA"!==i.tagName&&"STYLE"!==i.tagName&&"LINK"!==i.tagName||(l[s].parentElement?l[s].parentElement.replaceChild(i,l[s]):(console.log("Warning: Templates should only have one childnode"),l[s].appendChild(i))),this.place.push(i)}return this.place}async prepareTemplate(){this.debug&&console.log("Template:",this.template);let t=await this.setTemplate(this.template),e=document.createElement("div");e.innerHTML=t,e.querySelector("template")&&(e.innerHTML=e.querySelector("template")?t:`<template><center><pre>The template you are trying to import does not have a &lt;template&gt tag</pre><div style="color:red">${this.template}</div></enter></template>`);let i=e.querySelector("template").cloneNode(!0);i.removeAttribute("id"),this.templateNode=document.createElement("template");let a=this.getAttribute("data-dispatch")||"undefined";this.templateNode.innerHTML=i.innerHTML.replace(/\${dataDispatch\}/g,a),this.templateElem=this.templateNode.content;let o=this.templateElem.querySelectorAll("style");o&&o.length>0&&this.templateElem.appendChild(o[0]),0===this.place.length&&(await this.initDataNodes(this.templateNode),this.getAttribute("style")&&this.templateNode.setAttribute("style",this.getAttribute("style")))}async setContext(){window[this.constructor.name]||(window[this.constructor.name]=[]),window[this.constructor.name].push(this),this.childNodes.length>0&&this.getElementsByTagName("template")&&this.getElementsByTagName("template").length>0&&this.removeChild(this.getElementsByTagName("template").item(0));let t=this.getAttribute("context")||Doo.$Config.SHADOW;if(t===Doo.$Config.SHADOW){this.shadow.host.style.visibility="hidden";let t=this.templateElem.firstElementChild.hasAttribute("class")?" "+this.templateElem.firstElementChild.getAttribute("class"):"",e=this.hasAttribute("class")?this.getAttribute("class")+" ":"";e+t!==""&&this.templateElem.firstElementChild&&this.templateElem.firstElementChild.setAttribute("class",`${e}${t}`),this.shadow.appendChild(this.templateElem),this.componentContainer=this.shadow.host}else if(t===Doo.$Config.DOCUMENT){this.style.visibility="hidden";let t=this.parentElement.replaceChild(this.templateElem,this);this.componentContainer=t}this.initialHeight=this.shadow.firstElementChild.offsetHeight,this.shadow.firstElementChild.setAttribute("data-offset",this.initialHeight);const e=new Promise(t=>{let e=(navigator.userAgent.toUpperCase().includes("FIREFOX"),25),i=0,a=setInterval(()=>{i++,this.shadow.firstElementChild.setAttribute("data-offset",this.shadow.firstElementChild.offsetHeight);let e=parseInt(this.shadow.firstElementChild.getAttribute("data-offset"));(i>20||e!==this.initialHeight)&&(this.shadow.firstElementChild.removeAttribute("data-offset"),this.scrollTarget&&this.setScrollHeight(),clearInterval(a),t())},e)});await e,this.componentContainer.style.visibility="visible",this.ready=!0}async setScrollHeight(){this.scrollTarget&&(this.scrollElem=this.shadow.querySelector(this.scrollTarget),this.data[this.defaultDataSet]&&this.data[this.defaultDataSet].length>this.PAGE_SIZE&&this.addScrollWatcher())}getCurrentData(t){return this.getFilteredData(t)?this.getFilteredData(t):this.data[t]}getItemValueByType(t,e,i){switch(i.type){case Doo.$Config.TYPE.DEFAULT:case Doo.$Config.TYPE.DEEP:return this.getItemValue(t[e],i.fld);case Doo.$Config.TYPE.COMPUTED:let a=new Doo.DataItem(t[e],e,t);return a.fld=i.fld,a.func=i.func,a.$1=i.$1,a.$2=i.$2,a.$3=i.$3,a.$4=i.$4,a.$5=i.$5,a.instance=i.instance,i.func(a);case void 0:return""}}renderTable(t=this.data[this.defaultDataSet],e=0){let i=t.length-e,a=document.createElement("tbody");a.innerHTML=this.renderNode(this.place[0],t,e,i);let o,r=a.querySelectorAll("tr");for(let e=0;e<i;e++)o=this.place[0].appendChild(r.item(e)),o.key=t[e].id}async render(t=null,e=0,i=null){if(!this.template)return void console.log(this.name+" has no template defined");this.templateNode||this.ready||await this.prepareTemplate();let a=this.debug?(new Date).getTime():null;for(let a=0,o=this.place.length;a<o;a++){if(t&&t!==this.place[a].dataKey)continue;if(0===e&&"STYLE"!==this.place[a].tagName&&!this.place[a].classList.contains("fhead")){let t="dummy"===this.place[a].getAttribute(Doo.$Config.DATA_BIND)?-1:0;this.place[a].setAttribute("page",t)}let o=this.getCurrentData(this.place[a].dataKey);this.getFilteredData(this.place[a].dataKey)?this.getFilteredData(this.place[a].dataKey):this.data[this.place[a].dataKey];let r=this.place[a].noRepeat?1:this.PAGE_SIZE;if(null===i)if(e>0&&t===this.defaultDataSet){let t=this.scrollElem.querySelector('data[page="'+e+'"]');if(t)0===t.innerHTML.length&&(t.innerHTML=this.renderNode(this.place[a],o,e*this.PAGE_SIZE,r)),this.lastInsertedElem=t;else{let t="TABLE"===this.scrollElem.tagName?"tbody":"data",i=document.createElement(t);i.setAttribute("page",e),i.innerHTML=this.renderNode(this.place[a],o,e*this.PAGE_SIZE,r),!this.lastInsertedElem||e>this.lastPage?this.place[a].parentElement.appendChild(i):this.lastInsertedElem.insertAdjacentElement("beforebegin",i),this.lastInsertedElem=i}this.scrollTarget&&"TABLE"!==this.scrollElem.tagName&&(this.lastInsertedElem.style.top=e*this.blockHeight+"px",this.lastInsertedElem.style.position="absolute")}else this.place[a].useParent?this.place[a].innerHTML=this.renderNode(this.place[a],o,parseInt(this.getAttribute("key")),1):this.place[a].innerHTML=this.renderNode(this.place[a],o,e*this.PAGE_SIZE,r);else this.place[a].append(this.renderNode(this.place[a],o,i,1));t===this.defaultDataSet&&(this.lastPage=e)}if(this.ready||this.setContext(),this.debug){this.getAttribute("title")||this.setAttribute("title",this.id+":init() "+((new Date).getTime()-this.initialTime)+"ms");let t=(new Date).getTime()-a+"ms";this.setAttribute("doo-render-time",t),this.setAttribute("title",this.getAttribute("title")+"|"+t)}return e}static async fetchURL(t){return new Promise((e,i)=>{const a=new XMLHttpRequest;a.open("GET",t),a.onload=()=>e(a.responseText),a.onerror=()=>i(a.statusText),a.send()})}setHttpRequest(t,e){let i=this,a=new XMLHttpRequest;a.onload=()=>{e(this.responseText,i)},a.open("GET",t,!0),a.send()}hasScroll(t){return"auto"===this.getStyle(t,"overflow-y")||"scroll"===this.getStyle(t,"overflow-y")}getStyle(t,e,i=null){if(t)return t&&t.currentStyle?t.currentStyle[e]:window.getComputedStyle(t,i).getPropertyValue(e)}async sortBy(t,e){let i=this.defaultDataSet||this.getAttribute(Doo.$Config.DATA_BIND);this.lastPage=null;let a,o=t.getAttribute("sort-dir")||1;if(Doo.util.sortBy(this.getCurrentData(i),e,o),[...t.parentElement.querySelectorAll(".doo-sort")].forEach(t=>{t.classList.remove("dir_1","dir_-1")}),t.classList.add(-1*parseInt(o)==1?"dir_-1":"dir_1"),t.setAttribute("sort-dir",-1*o),this.scrollElem&&(a=this.scrollElem.querySelectorAll("[page]"),a&&(a[0].innerHTML="")),this.lastInsertedElem=null,this.rendering=!0,await this.render(i,0),this.rendering=!1,this.container&&(this.container.scrollTop=0),a&&a.length>0)for(let t=a.length-1;t>0;t--)a[t].remove()}clearChildren(t,e="[page]"){if(this.scrollElem){let i=this.scrollElem.querySelectorAll(e);for(let e=i.length-1;e>0;e--)t&&t.find(t=>t===parseInt(i[e].getAttribute("page")))||i[e].remove()}}async setScrollContainerHeight(t){let e=t||this.data[this.defaultDataSet].length;this.scrollElem.style.height=this.rowHeight*e+"px"}async windowWatcher(){document.body.setAttribute("doo-height",window.offsetHeight)}async addScrollWatcher(){if(this.scrollTarget&&(this.scrollElem=this.shadow.firstElementChild.querySelector(this.scrollTarget),this.scrollElem&&this.data[this.defaultDataSet].length>this.PAGE_SIZE)){this.scrollElem.style.position="relative",this.container=this.scrollElem.parentElement,this.rowHeight=this.scrollElem.offsetHeight/this.PAGE_SIZE,this.headerHeight=this.scrollElem.firstElementChild.offsetHeight,this.setScrollContainerHeight(),this.blockHeight=this.PAGE_SIZE*this.rowHeight;let t=!1;for(;this.blockHeight<this.container.offsetHeight;)this.PAGE_SIZE=2*this.PAGE_SIZE,this.blockHeight=this.PAGE_SIZE*this.rowHeight,t=!0;t&&await this.render(this.defaultDataSet,this.lastPage||0),this.lastScrollPos=0,this.componentContainer.setAttribute("data-container-height",this.componentContainer.offsetHeight),this.container.addEventListener("scroll",this.scrollWatcher.bind(this))}}async scrollWatcher(){if(!this.rendering){this.rendering=!0;let t=parseInt(this.container.scrollTop/this.blockHeight),e=parseInt((t*this.blockHeight+this.blockHeight)/this.blockHeight),i=this.container.scrollTop>this.lastScrollPos?1:0,a=this.scrollElem.querySelector('data[page="'+t+'"]'),o=this.scrollElem.querySelector('data[page="'+e+'"]');!a||e>t?(o||this.render(this.defaultDataSet,e),this.currentPage=this.render(this.defaultDataSet,t)):t!=this.currentPage&&(this.currentPage=this.render(this.defaultDataSet,t));let r=1===i?[t-1,t,e]:[t,t+1];this.clearChildren(r),this.lastScrollPos=this.container.scrollTop,this.rendering=!1}}}Doo.FieldType=class{constructor(t,e,i,a){this._fld=t,this.type=e,this.klass=i,this.instance=a,this._func=void 0,this._parentElem=void 0,this.$1=void 0,this.$2=void 0,this.$3=void 0,this.$4=void 0,this.$5=void 0,this.type===Doo.$Config.TYPE.COMPUTED&&this.createComputed()}set fld(t){this._fld=t}set parentElem(t){this._parentElem=t}set func(t){this._func=t}get fld(){return this._fld}get func(){return this._func}createComputed(){let t=this.fld.split("("),e=t[0].split(".").reverse(),i=e[0];Reflect.ownKeys(this.klass).filter(t=>t===i).length>0?(this.func=this.klass[i],Doo.$Computed[i]&&console.log("WARNING: ","Overwriting a Doo base Doo.$Computed method is not recommended")):Doo.$Computed[i]&&(this.func=Doo.$Computed[i]),this.fld=e.length>1?e[1]:void 0,"function"!=typeof this.func&&console.log("static "+i+"() is not defined in Doo nor has it been defined as a static function in this component");let a=t[1].replace(")","");if(a&&a.length>0){a=a.split(",");for(let t=0,e=a.length;t<e;t++)this["$"+(t+1)]=a[t].replace(/'/g,"").replace(/"/g,"")}}},Doo.DataItem=class{constructor(t,e,i){this.item=t,this.i=e,this.arr=i,this._dataSetKey="",this._fld="",this._args=[],this._searchable=!0}set dataSetKey(t){this._dataSetKey=t}set fld(t){this._fld=t}set args(t){this._args=t}set filterKey(t){this._filterKey=t}set searchAble(t){this._searchAble=new Boolean(t)}get fld(){return this._fld}get length(){return this.arr.length}get filterKey(){return this._filterKey}isSearchable(){return this.searchable}getValue(){return this.item[this.fld]}toString(){return JSON.stringify(this.item)}},Doo.Criteria=class{constuctor(t){this.name=t}},Doo.EMPTY_ROW=function(t,e){return new Doo.DataItem(t[0],e,[""])},window.Doo||(window.Doo=Doo);class Html extends Doo{constructor(){super(),this.data={}}async connectedCallback(){let t=document.querySelector("doo-bind");if(t&&!t.hasAttribute("is-ready")&&await this.initDooBind(window.isReady),this.hasAttribute("bind")){let t=this.getAttribute("bind");this.hasAttribute("data-src")?this.data[t]=await this.getDataObj(this.getAttribute("data-src")):(this.setAttribute("doo-dispatch",this.id+"_"+t),this.data[t]=await Doo.DAO.getData(t))}this.template=this.getAttribute("template"),"function"==typeof this.dooAfterRender&&await this.dooAfterRender(),super.connectedCallback()}}Doo.define(Html,"html")},function(t,e,i){var a={"./doo.dao":0,"./doo.dao.js":0,"./doo.html":2,"./doo.html.js":2,"./doo.util":1,"./doo.util.js":1};function o(t){return Promise.resolve().then((function(){if(!i.o(a,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return i(a[t])}))}o.keys=function(){return Object.keys(a)},o.id=3,t.exports=o}]);