/* esm.sh - esbuild bundle(@arrow-js/core@1.0.0-alpha.9) es2022 production */
var E = new Set, $ = new Set; function te(e) { if (!E.size) return e && e(), Promise.resolve(); let o, n = new Promise(t => { o = t }); return $.add(() => { e && e(), o() }), n } function k(e) { return typeof e == "function" && !!e.isT } function R(e) { return typeof e == "object" && e !== null && "$on" in e && typeof e.$on == "function" } function I(e) { return "$on" in e } function W(e) { return (o, n) => { function t() { let a = Array.from(E); E.clear(); let p = Array.from($); $.clear(), a.forEach(r => r(o, n)), p.forEach(r => r()), E.size && setTimeout(t) } E.size || setTimeout(t), E.add(e) } } var ne = {}, w = new Map; function C(e, o = {}) { if (R(e) || typeof e != "object") return e; let n = o.o || new Map, t = o.op || new Map, a = Array.isArray(e), p = [], r = a ? [] : Object.create(e, {}); for (let c in e) { let s = e[c]; typeof s == "object" && s !== null ? (r[c] = R(s) ? s : C(s), p.push(c)) : r[c] = s } let i = c => (s, m) => { let l = n.get(s), y = t.get(m); l || (l = new Set, n.set(s, l)), y || (y = new Set, t.set(m, y)), l[c](m), y[c](s) }, u = i("add"), h = i("delete"), g = (c, s, m) => { n.has(c) && n.get(c).forEach(l => l(s, m)) }, d = { $on: u, $off: h, _em: g, _st: () => ({ o: n, op: t, r, p: f._p }), _p: void 0 }, f = new Proxy(r, { has(c, s) { return s in d || s in c }, get(...c) { let [, s] = c; if (Reflect.has(d, s)) return Reflect.get(d, s); let m = Reflect.get(...c); return H(f, s), a && s in Array.prototype ? Q(s, r, f, m) : m }, set(...c) { let [s, m, l] = c, y = Reflect.get(s, m); if (Reflect.has(d, m)) return Reflect.set(d, m, l); if (l && R(y)) { let b = y, A = b._st(), M = R(l) ? B(l, b) : C(l, A); return Reflect.set(s, m, M), g(m, M), A.o.forEach((ee, N) => { let D = Reflect.get(y, N), V = Reflect.get(M, N); D !== V && b._em(N, V, D) }), !0 } let v = Reflect.set(...c); return v && (y !== l && g(m, l, y), f._p && f._p[1]._em(...f._p)), v } }); return o.p && (f._p = o.p), p.map(c => { f[c]._p = [c, f] }), f } function H(e, o) { w.forEach(n => { let t = n.get(e); t || (t = new Set, n.set(e, t)), t.add(o) }) } function Q(e, o, n, t) { let a = (...p) => { let r = Array.prototype[e].call(o, ...p); if (o.forEach((i, u) => n._em(String(u), i)), n._p) { let [i, u] = n._p; u._em(i, n) } return r }; switch (e) { case "shift": case "pop": case "sort": case "reverse": case "copyWithin": return a; case "unshift": case "push": case "fill": return (...p) => a(...p.map(r => C(r))); case "splice": return (p, r, ...i) => a(p, r, ...i.map(u => C(u))); default: return t } } function B(e, o) { let n = o._st(); return n.o && n.o.forEach((t, a) => { t.forEach(p => { e.$on(a, p) }) }), n.p && (e._p = n.p), e } function T(e, o) { let n = Symbol(); w.has(n) || w.set(n, new Map); let t = new Map, a = W(p); function p() { w.set(n, new Map); let r = e(), i = w.get(n); return w.delete(n), t.forEach((u, h) => { let g = i.get(h); g && g.forEach(_ => u.delete(_)), u.forEach(_ => h.$off(_, a)) }), i.forEach((u, h) => { u.forEach(g => h.$on(g, a)) }), t = i, o ? o(r) : r } return I(e) && e.$on(p), p() } var S = new WeakMap, F = {}, L = "\u27B3\u274D", O = "\u274D\u21DA", q = `<!--${L}-->`, G = `<!--${O}-->`; function z(e, ...o) { let n = [], t = "", a = (i, u) => { if (typeof i == "function") { let h = () => { }; return n.push(Object.assign((...g) => i(...g), { e: i, $on: g => { h = g }, _up: g => { i = g, h() } })), u + q } return Array.isArray(i) ? i.reduce((h, g) => a(g, h), u) : u + i }, p = () => (t || (!o.length && e.length === 1 && e[0] === "" ? t = "<!---->" : t = e.reduce(function (u, h, g) { return u += h, o[g] !== void 0 ? a(o[g], u) : u }, "")), t), r = i => { let u = j(p()), h = P(u, { i: 0, e: n }); return i ? h(i) : h() }; return r.isT = !0, r._k = 0, r._h = () => [p(), n, r._k], r.key = i => (r._k = i, r), r } function P(e, o) { let n = document.createDocumentFragment(), t; for (; t = e.item(0);) { if (t.nodeType === 8 && t.nodeValue === L) { n.append(X(t, o)); continue } t instanceof Element && J(t, o), t.hasChildNodes() && P(t.childNodes, o)(t), n.append(t), t instanceof HTMLOptionElement && (t.selected = t.defaultSelected) } return a => a ? (a.appendChild(n), a) : n } function J(e, o) { var n; let t = [], a = 0, p; for (; p = e.attributes[a++];) { if (o.i >= o.e.length) return; if (p.value !== q) continue; let r = p.name, i = o.e[o.i++]; if (r.charAt(0) === "@") { let u = r.substring(1); e.addEventListener(u, i), S.has(e) || S.set(e, new Map), (n = S.get(e)) === null || n === void 0 || n.set(u, i), t.push(r) } else { let u = r === "value" && "value" in e || r === "checked" || r.startsWith(".") && (r = r.substring(1)); T(i, h => { u && (e[r] = h, e.getAttribute(r) != h && (h = !1)), h !== !1 ? e.setAttribute(r, h) : (e.removeAttribute(r), a--) }) } } t.forEach(r => e.removeAttribute(r)) } function K(e) { e.forEach(U) } function U(e) { var o; e.remove(), (o = S.get(e)) === null || o === void 0 || o.forEach((n, t) => e.removeEventListener(t, n)) } function X(e, o) { let n = document.createDocumentFragment(); e.remove(); let t = o.e[o.i++]; if (t && k(t.e)) n.appendChild(x().add(t.e)()); else { let a; n.appendChild((a = T(t, p => Y(p, a)))()) } return n } function Y(e, o) { let n = typeof o == "function", t = n ? o : x(); return Array.isArray(e) ? e.forEach(a => t.add(a)) : t.add(e), n && t._up(), t } function j(e) { var o; let t = ((o = F[e]) !== null && o !== void 0 ? o : (() => { let a = document.createElement("template"); return a.innerHTML = e, F[e] = a })()).content.cloneNode(!0); return t.normalize(), t.childNodes } function x(e = Symbol()) { let o = "", n = { i: 0, e: [] }, t = [], a = [], p = new Map, r = [], i = () => { let d; if (t.length || h(), t.length === 1 && !k(t[0].tpl)) { let f = t[0]; f.dom.length ? f.dom[0].nodeValue = f.tpl : f.dom.push(document.createTextNode(f.tpl)), d = f.dom[0] } else d = g(P(j(o), n)()); return u(), d }; i.ch = () => a, i.l = 0, i.add = d => { if (!d && d !== 0) return i; let f = [], c, s = ""; k(d) && ([s, f, c] = d._h()), o += s, o += G; let m = c && p.get(c), l = m || { html: s, exp: f, dom: [], tpl: d, key: c }; return t.push(l), c && (m ? m.exp.forEach((y, v) => y._up(f[v].e)) : p.set(c, l)), n.e.push(...f), i.l++, i }, i._up = () => { let d = x(e), f = 0, c = a[0].dom[0]; t.length || h(document.createComment("")); let s = () => { if (!d.l) return; let l = d(), y = l.lastChild; c[f ? "after" : "before"](l), _(d, t, f), c = y }; t.forEach((l, y) => { let v = a[y]; l.key && l.dom.length ? (s(), (!v || v.dom !== l.dom) && c[y ? "after" : "before"](...l.dom), c = l.dom[l.dom.length - 1]) : v && l.html === v.html && !v.key ? (s(), v.exp.forEach((b, A) => b._up(l.exp[A].e)), l.exp = v.exp, l.dom = v.dom, c = l.dom[l.dom.length - 1], Z(l) && c instanceof Text && (c.nodeValue = l.tpl)) : (v && l.html !== v.html && !v.key && r.push(...v.dom), d.l || (f = y), d.add(l.tpl)) }), s(); let m = c?.nextSibling; for (; m && e in m;)r.push(m), m = m.nextSibling; K(r), u() }; let u = () => { r.length = 0, o = "", i.l = 0, n = { i: 0, e: [] }, a = [...t], t = [] }, h = d => { o = "<!---->", t.push({ html: o, exp: [], dom: d ? [d] : [], tpl: z`${o}`, key: 0 }) }, g = d => { let f = 0, c = []; return d.childNodes.forEach(s => { if (s.nodeType === 8 && s.data === O) { f++, c.push(s); return } Object.defineProperty(s, e, { value: e }), t[f].dom.push(s) }), c.forEach(s => s.remove()), d }, _ = (d, f, c) => { d.ch().forEach((s, m) => { f[c + m].dom = s.dom }) }; return i } function Z(e) { return e.dom.length === 1 && !k(e.tpl) } var oe = z, re = C, ce = T; export { oe as html, ne as measurements, te as nextTick, C as r, re as reactive, z as t, T as w, ce as watch };
//# sourceMappingURL=core.mjs.map